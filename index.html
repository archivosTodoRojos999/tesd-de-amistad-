  
  <!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gashiras Devil</title>
<style>
body {
  margin: 0;
  overflow: hidden;
  background: #8b5a00;
}

canvas {
  display: block;
}

.controls {
  position: fixed;
  bottom: 20px;
  width: 100%;
  display: flex;
  justify-content: space-between;
  padding: 0 40px;
}

.btn {
  width: 70px;
  height: 70px;
  background: #c68c3c;
  border: 4px solid #a06a2a;
  border-radius: 10px;
  font-size: 30px;
}

.jump {
  position: fixed;
  right: 30px;
  bottom: 120px;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<div class="controls">
  <button class="btn" id="left">â¬…ï¸</button>
  <button class="btn" id="right">â¡ï¸</button>
</div>

<button class="btn jump" id="jump">â¬†ï¸</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player = {
  x: 50,
  y: 300,
  w: 15,
  h: 25,
  dy: 0,
  gravity: 0.6,
  jump: -10,
  grounded: false
};

let keys = { left:false, right:false, jump:false };

let ground = {
  x: 0,
  y: canvas.height / 2,
  w: canvas.width,
  h: 100
};

let door = {
  x: canvas.width - 80,
  y: ground.y - 40,
  w: 30,
  h: 40
};

// ğŸ˜ˆ trampas
let spikes = [];
let fallingBlocks = [];
let fakeGround = false;
let invisibleWall = false;
let reverseControls = false;

// controles tÃ¡ctiles
left.ontouchstart = ()=> keys.left=true;
left.ontouchend = ()=> keys.left=false;

right.ontouchstart = ()=> keys.right=true;
right.ontouchend = ()=> keys.right=false;

jump.ontouchstart = ()=> keys.jump=true;
jump.ontouchend = ()=> keys.jump=false;

// teclado
document.addEventListener("keydown", e=>{
  if(e.key==="ArrowLeft") keys.left=true;
  if(e.key==="ArrowRight") keys.right=true;
  if(e.key===" ") keys.jump=true;
});

document.addEventListener("keyup", e=>{
  if(e.key==="ArrowLeft") keys.left=false;
  if(e.key==="ArrowRight") keys.right=false;
  if(e.key===" ") keys.jump=false;
});

function reset(){
  player.x = 50;
  player.y = ground.y - player.h;
  spikes = [];
  fallingBlocks = [];
  fakeGround = false;
  invisibleWall = false;
  reverseControls = false;
}

// ğŸ”¥ UPDATE
function update(){

  let speed = 4;

  // ğŸ˜ˆ controles invertidos random
  if (Math.random() < 0.002) {
    reverseControls = !reverseControls;
  }

  if (reverseControls) {
    if (keys.left) player.x += speed;
    if (keys.right) player.x -= speed;
  } else {
    if (keys.left) player.x -= speed;
    if (keys.right) player.x += speed;
  }

  // salto
  if (keys.jump && player.grounded) {
    player.dy = player.jump;
    player.grounded = false;
  }

  player.dy += player.gravity;
  player.y += player.dy;

  player.grounded = false;

  // ğŸ˜ˆ suelo falso
  if (player.x > canvas.width/2 && !fakeGround) {
    fakeGround = true;
  }

  if (!fakeGround) {
    if (player.y + player.h >= ground.y) {
      player.y = ground.y - player.h;
      player.dy = 0;
      player.grounded = true;
    }
  }

  // ğŸ˜ˆ pared invisible
  if (Math.random() < 0.003) {
    invisibleWall = true;
  }

  if (invisibleWall && player.x > canvas.width/3) {
    player.x -= 5;
  }

  // ğŸ˜ˆ spikes random
  if (Math.random() < 0.02) {
    spikes.push({
      x: Math.random()*canvas.width,
      y: ground.y-20,
      w:20,
      h:20
    });
  }

  spikes.forEach(s=>{
    if(
      player.x < s.x+s.w &&
      player.x+player.w > s.x &&
      player.y < s.y+s.h &&
      player.y+player.h > s.y
    ){
      alert("ğŸ’€ Pinchos troll!");
      reset();
    }
  });

  // ğŸ˜ˆ bloques que caen
  if (Math.random() < 0.02) {
    fallingBlocks.push({
      x: Math.random()*canvas.width,
      y: 0,
      w:30,
      h:30,
      dy:4
    });
  }

  fallingBlocks.forEach(b=>{
    b.y += b.dy;

    if(
      player.x < b.x+b.w &&
      player.x+player.w > b.x &&
      player.y < b.y+b.h &&
      player.y+player.h > b.y
    ){
      alert("ğŸ’€ Te cayÃ³ algo!");
      reset();
    }
  });

  // perder
  if (player.y > canvas.height){
    alert("ğŸ’€ CaÃ­ste!");
    reset();
  }

  // ganar
  if(
    player.x < door.x+door.w &&
    player.x+player.w > door.x &&
    player.y < door.y+door.h &&
    player.y+player.h > door.y
  ){
    alert("ğŸ”¥ Ganaste nivel troll!");
    reset();
  }
}

// ğŸ¨ DIBUJO
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle="#f0b35a";
  if(!fakeGround){
    ctx.fillRect(ground.x,ground.y,ground.w,ground.h);
  }

  ctx.fillStyle="red";
  spikes.forEach(s=>{
    ctx.fillRect(s.x,s.y,s.w,s.h);
  });

  ctx.fillStyle="gray";
  fallingBlocks.forEach(b=>{
    ctx.fillRect(b.x,b.y,b.w,b.h);
  });

  ctx.fillStyle="#ccc";
  ctx.fillRect(door.x,door.y,door.w,door.h);

  ctx.fillStyle="black";
  ctx.fillRect(player.x,player.y,player.w,player.h);
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

reset();
loop();
</script>

</body>
</html>
