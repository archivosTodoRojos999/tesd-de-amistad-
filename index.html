  <!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gashiras Devil</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: black;
  }
  canvas {
    display: block;
    background: linear-gradient(#111, #222);
  }
</style>
</head>
<body>

<canvas id="game"></canvas>

<audio id="bgMusic" loop>
  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player = {
  x: 50,
  y: 300,
  w: 30,
  h: 30,
  dy: 0,
  gravity: 0.6,
  jump: -12,
  grounded: false
};

let level = 1;

let keys = {};

document.addEventListener("keydown", e => {
  keys[e.key] = true;

  // activar mÃºsica
  document.getElementById("bgMusic").play();
});

document.addEventListener("keyup", e => {
  keys[e.key] = false;
});

let platforms = [];
let spikes = [];

function generateLevel() {
  platforms = [];
  spikes = [];

  for (let i = 0; i < 5 + level; i++) {
    let x = 150 * i + 200;
    let y = Math.random() * (canvas.height - 200) + 100;

    platforms.push({ x, y, w: 100, h: 20 });

    // trampas locas
    if (Math.random() < 0.5) {
      spikes.push({ x: x + 30, y: y - 20, w: 40, h: 20 });
    }
  }
}

generateLevel();

function reset() {
  player.x = 50;
  player.y = 300;
  player.dy = 0;
  generateLevel();
}

function update() {
  // movimiento
  if (keys["ArrowRight"]) player.x += 5;
  if (keys["ArrowLeft"]) player.x -= 5;

  // salto
  if (keys[" "] && player.grounded) {
    player.dy = player.jump;
    player.grounded = false;
  }

  // gravedad
  player.dy += player.gravity;
  player.y += player.dy;

  player.grounded = false;

  // colisiones plataformas
  platforms.forEach(p => {
    if (
      player.x < p.x + p.w &&
      player.x + player.w > p.x &&
      player.y < p.y + p.h &&
      player.y + player.h > p.y
    ) {
      player.y = p.y - player.h;
      player.dy = 0;
      player.grounded = true;
    }
  });

  // trampas
  spikes.forEach(s => {
    if (
      player.x < s.x + s.w &&
      player.x + player.w > s.x &&
      player.y < s.y + s.h &&
      player.y + player.h > s.y
    ) {
      alert("ðŸ’€ Perdiste!");
      reset();
    }
  });

  // suelo falso ðŸ˜ˆ
  if (Math.random() < 0.01 * level) {
    platforms.pop();
  }

  // ganar nivel
  if (player.x > canvas.width - 50) {
    level++;
    alert("ðŸ”¥ Nivel " + level);
    reset();
  }

  // caÃ­da
  if (player.y > canvas.height) {
    reset();
  }
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // jugador
  ctx.fillStyle = "white";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // plataformas
  ctx.fillStyle = "green";
  platforms.forEach(p => {
    ctx.fillRect(p.x, p.y, p.w, p.h);
  });

  // spikes
  ctx.fillStyle = "red";
  spikes.forEach(s => {
    ctx.fillRect(s.x, s.y, s.w, s.h);
  });

  // nivel
  ctx.fillStyle = "white";
  ctx.font = "20px Arial";
  ctx.fillText("Nivel: " + level, 20, 30);
}

function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
