<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Casa del Terror</title>
<style>
body { margin: 0; overflow: hidden; background: black; }
#mensaje {
  position: absolute;
  top: 20px;
  width: 100%;
  text-align: center;
  color: white;
  font-size: 20px;
}
</style>
</head>
<body>

<div id="mensaje">Encuentra la salida... (WASD para moverte)</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
let scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);

let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
let renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// luz tenue
let light = new THREE.PointLight(0xaaaaaa, 0.5);
light.position.set(0,2,0);
scene.add(light);

// piso
let floor = new THREE.Mesh(
  new THREE.BoxGeometry(20,1,20),
  new THREE.MeshStandardMaterial({color: 0x111111})
);
floor.position.y = -1;
scene.add(floor);

// paredes (casa)
function wall(x,z){
  let w = new THREE.Mesh(
    new THREE.BoxGeometry(20,5,1),
    new THREE.MeshStandardMaterial({color: 0x222222})
  );
  w.position.set(x,2,z);
  scene.add(w);
}
wall(0,-10);
wall(0,10);

let sideWall1 = new THREE.Mesh(
  new THREE.BoxGeometry(1,5,20),
  new THREE.MeshStandardMaterial({color: 0x222222})
);
sideWall1.position.set(-10,2,0);
scene.add(sideWall1);

let sideWall2 = sideWall1.clone();
sideWall2.position.x = 10;
scene.add(sideWall2);

// puerta salida
let door = new THREE.Mesh(
  new THREE.BoxGeometry(2,3,0.5),
  new THREE.MeshStandardMaterial({color: 0x00ff00})
);
door.position.set(0,1.5,-9);
scene.add(door);

// enemigo (la "vieja")
let enemy = new THREE.Mesh(
  new THREE.SphereGeometry(0.7),
  new THREE.MeshStandardMaterial({color: 0xff0000})
);
enemy.position.set(5,1,5);
scene.add(enemy);

camera.position.y = 1.5;

// controles
let keys = {};

document.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
document.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

// mouse cÃ¡mara
document.addEventListener("mousemove", e=>{
  camera.rotation.y -= e.movementX * 0.002;
});

// loop
function animate(){
  requestAnimationFrame(animate);

  let speed = 0.1;

  if(keys["w"]) camera.position.z -= speed;
  if(keys["s"]) camera.position.z += speed;
  if(keys["a"]) camera.position.x -= speed;
  if(keys["d"]) camera.position.x += speed;

  // enemigo te sigue ðŸ˜ˆ
  enemy.position.x += (camera.position.x - enemy.position.x) * 0.01;
  enemy.position.z += (camera.position.z - enemy.position.z) * 0.01;

  // perder
  let dx = enemy.position.x - camera.position.x;
  let dz = enemy.position.z - camera.position.z;
  let dist = Math.sqrt(dx*dx + dz*dz);

  if(dist < 1){
    alert("ðŸ’€ Te atrapÃ³!");
    location.reload();
  }

  // ganar
  if(
    Math.abs(camera.position.x - door.position.x) < 1 &&
    Math.abs(camera.position.z - door.position.z) < 1
  ){
    alert("ðŸšª Escapaste!");
    location.reload();
  }

  renderer.render(scene, camera);
}

animate();
</script>

</body>
</html>
