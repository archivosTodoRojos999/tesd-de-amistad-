
<!DOCTYPE html>
<html>
<head>
  <title>IA PRO WEB</title>
  <style>
    body { background:#0f0f0f; color:white; font-family:Arial; }
    #chat { max-width:700px; margin:auto; height:70vh; overflow-y:auto; }
    .msg { padding:10px; margin:8px; border-radius:10px; }
    .user { background:#1e1e1e; text-align:right; }
    .ai { background:#333; }
    input, button { padding:10px; margin:5px; }
  </style>
</head>
<body>

<h2 style="text-align:center;">IA Nivel Dios</h2>

<div id="chat"></div>

<div style="text-align:center;">
  <input id="input" placeholder="Escribe..." />
  <button onclick="enviar()">Enviar</button>

  <br>
  <input type="file" id="pdfFile" />
  <button onclick="leerPDF()">Cargar PDF</button>

  <br>
  <button onclick="imagen()">Generar Imagen</button>
</div>

<script>
const API_KEY = "TU_API_KEY"; // ‚ö†Ô∏è NO seguro en producci√≥n

let memoria = JSON.parse(localStorage.getItem("chat")) || [];
let pdfTexto = "";

function guardar() {
  localStorage.setItem("chat", JSON.stringify(memoria));
}

function agregar(texto, clase) {
  const div = document.createElement("div");
  div.className = "msg " + clase;
  div.innerText = texto;
  document.getElementById("chat").appendChild(div);
}

// üìÑ Leer PDF (solo cliente)
async function leerPDF() {
  const file = document.getElementById("pdfFile").files[0];
  const reader = new FileReader();

  reader.onload = function() {
    pdfTexto = reader.result.slice(0, 3000);
    alert("PDF cargado (texto b√°sico)");
  };

  reader.readAsText(file);
}

// ü§ñ Chat
async function enviar() {
  const input = document.getElementById("input").value;
  agregar(input, "user");

  memoria.push(input);
  guardar();

  const contexto = pdfTexto ? "PDF: " + pdfTexto : "";

  const res = await fetch("https://api.openai.com/v1/responses", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + API_KEY
    },
    body: JSON.stringify({
      model: "gpt-4.1-mini",
      input: contexto + "\n" + memoria.slice(-5).join("\n")
    })
  });

  const data = await res.json();
  const respuesta = data.output[0].content[0].text;

  agregar(respuesta, "ai");

  memoria.push(respuesta);
  guardar();
}

// üñºÔ∏è Imagen
async function imagen() {
  const prompt = prompt("Describe la imagen:");

  const res = await fetch("https://api.openai.com/v1/images/generations", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + API_KEY
    },
    body: JSON.stringify({
      model: "gpt-image-1",
      prompt: prompt
    })
  });

  const data = await res.json();

  const img = document.createElement("img");
  img.src = data.data[0].url;
  img.style.width = "300px";

  document.getElementById("chat").appendChild(img);
}
</script>

</body>
</html>
